# Код реферала в Google Tag Manager
## Руководство пользователя

В случае реализации продаж товаров или услуг по партнерской (реферальной программы), 
то часто стоит задача правильного учёта объема продаж отдельного партнёра (реферала). 
В этом случае обычно используются так называемые реферальные ссылки -- присвовение каждому партнёру уникального кода, 
который тот использует в ссылке на ваш сайт, например, http://example.com/?ref=ABC.

При переходе на сайт с таким кодом (ABC), сайт должен зафиксировать с каким кодом выполнен этот переход 
и если этот пользователь сделает покупку на сайте, то учесть эту покупку указанному кодом партнеру (рефералу).

Этот плагин реализует справочник (реестр) партнеров и их кодов, учёт переходов по партнерской ссылке и передачу данных о партнёре 
в [Google Tag Manager](https://tagmanager.google.com/). 
Учёт продаж и статистика работы партнеров осуществляется на уровне аналитических сервисов, 
таких как [Google Analytics](https://analytics.google.com/analytics/web/) 
или [Яндекс.Метрика](https://metrika.yandex.ru/).

Для этого необходимо устравить и настроить плагин и аналичтические службы. Ниже приведена подробная инструкция.

## Установка плагина
1. Скачайте [актуальную версию плагина IN-REG-GTM](https://github.com/ivannikitin-com/in-ref-gtm/archive/master.zip).
2. Установите плагин штатными средствами WordPress (Плагины --> Добавить новый --> Загрузить плагин).
3. Активируйте плагин

## Указание рефералов и их кодов
Перейдите в в раздел WordPress "Пользователи". Нажмите "Добавить нового" или "Изменить" для существующего пользователя, 
который должен быть зарегистрирован как реферал. Укажите правильные данные пользователя (E-mail, имя, фамилия). 
Обратите внимание на параметр "Роль", выберите из списка и установите значение "Партнёр".
Обратите внимание на поле "Отображать как", именно это значение будет передаваться в Google Tag Manager. Установите предпочитаемый вид.

![Параметры пользователя](assets/img/user-settings.png?raw=true)

Ниже в профиле пользователя найдите и укажите его код в поле "Код партнера". Этот код должен быть уникальным. 
Плагин не проверяет уникальность кода, но если он будет дублироваться для нескольких пользователей, плагин будет засчитывать продажи
только первому найденному пользователю.

![Указание кода партнера](assets/img/user-refcode.png?raw=true)

Сохраните изменения, нажав кнопку "Схранить". 

Перейдите к списку всех пользователей "Пользователи --> Все пользователи". 
В правом версхнем углу экрана найтите "Настройка экрана" и раскройте его. Убедитесь, что галочка "Код партнёра" установлена. 
Сохраните изменения.

![Установка показа колонки Код партнера](assets/img/user-screen-settings.png?raw=true)

Перейдите в список партнёров. Сообщите каждому партнёру его код.

![Список партнеров](assets/img/user-screen-role.png?raw=true)

## Настройки партнёрской программы




